(this.webpackJsonpadxsheets=this.webpackJsonpadxsheets||[]).push([[0],{76:function(e,t,s){},86:function(e,t,s){"use strict";s.r(t);var a=s(0),r=s.n(a),i=s(11),n=s.n(i),o=(s(76),s(130)),c=s(2);var h=({toggleManagePowers:e,toggleManageArch:t,toggleManageStats:s})=>Object(c.jsx)("nav",{className:"navbar navbar-light bg-light",children:Object(c.jsxs)("div",{className:"navbar-brand",padding:"normal",children:[Object(c.jsx)(o.a,{color:"primary",variant:"contained",onClick:e,children:"Powers"}),"\xa0",Object(c.jsx)(o.a,{color:"primary",variant:"contained",onClick:t,children:"Archetype/Level"}),"\xa0",Object(c.jsx)(o.a,{color:"primary",variant:"contained",onClick:s,children:"Stats"})]})}),l=s(133),d=s(135),p=s(119),u=s(134);class j extends r.a.Component{constructor(e){super(e),this.state={purchased:this.props.purchased}}setPurchased(e,t){this.setState({purchased:e}),this.props.purchase(this.props.name,e,t)}componentDidMount(){}render(){if(0==this.state.purchased){var e=Number(this.props.remainingCP);return Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:this.props.name}),Object(c.jsx)("td",{children:this.props.majorCost>0&&this.props.majorCost<=e&&Object(c.jsxs)(o.a,{color:"primary",variant:"contained",onClick:()=>this.setPurchased(3,this.props.majorCost),children:[this.props.majorCost," "]})}),Object(c.jsx)("td",{children:this.props.minorCost>0&&this.props.minorCost<=e&&Object(c.jsxs)(o.a,{color:"primary",variant:"contained",onClick:()=>this.setPurchased(2,this.props.minorCost),children:[this.props.minorCost," "]})}),Object(c.jsx)("td",{children:this.props.lesserCost>0&&this.props.lesserCost<=e&&Object(c.jsxs)(o.a,{color:"primary",variant:"contained",onClick:()=>this.setPurchased(1,this.props.lesserCost),children:[this.props.lesserCost," "]})})]})}return Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{children:this.props.name}),Object(c.jsx)("td",{children:3==this.state.purchased&&Object(c.jsx)(o.a,{color:"secondary",variant:"contained",onClick:()=>this.setPurchased(0,0-this.props.majorCost),children:"X "})}),Object(c.jsx)("td",{children:2==this.state.purchased&&Object(c.jsx)(o.a,{color:"secondary",variant:"contained",onClick:()=>this.setPurchased(0,0-this.props.minorCost),children:"X "})}),Object(c.jsx)("td",{children:1==this.state.purchased&&Object(c.jsx)(o.a,{color:"secondary",variant:"contained",onClick:()=>this.setPurchased(0,0-this.props.lesserCost),children:"X "})})]})}}class b extends r.a.Component{constructor(e){super(e),this.state={selectedPowers:this.props.selectedPowers,remainingCP:this.props.totalCP}}componentDidMount(){var e=this.props.totalCP,t=this.props.selectedPowers;this.props.powerData.forEach((s=>{if(t[s.Power])switch(t[s.Power]){case 1:e-=Number(s.Lesser);break;case 2:e-=Number(s.Minor);break;case 3:e-=Number(s.Major);break;default:return}})),this.setState({remainingCP:e})}render(){return Object(c.jsxs)(l.a,{"aria-describedby":"Manage Powers","aria-labelledby":"Manage Powers",className:"manage-powers-dialog",fullWidth:!0,onClose:this.props.handleClose,open:!0,children:[Object(c.jsx)(d.a,{children:"Manage Powers"}),Object(c.jsx)(p.a,{children:Object(c.jsxs)("form",{onSubmit:e=>this.props.handleConfirm(this.state.selectedPowers),children:[Object(c.jsxs)(u.a,{required:!0,variant:"outlined",children:["Remaining CP: ",this.state.remainingCP,Object(c.jsxs)("table",{children:[Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("th",{children:"Power"}),Object(c.jsx)("th",{children:"Major"}),Object(c.jsx)("th",{children:"Minor"}),Object(c.jsx)("th",{children:"Lesser"})]})}),Object(c.jsx)("tbody",{children:this.props.powerData&&this.props.powerData.map(((e,t)=>{if(e.Major||e.Minor||e.Lesser)return Object(c.jsx)(j,{name:e.Power,majorCost:e.Major,minorCost:e.Minor,lesserCost:e.Lesser,purchase:(e,t,s)=>this.purchasePower(e,t,s),purchased:this.state.selectedPowers[e.Power]?this.state.selectedPowers[e.Power]:0,remainingCP:this.state.remainingCP},t)}))})]})]}),Object(c.jsxs)("div",{className:"actionButtons",children:[Object(c.jsx)(o.a,{onClick:()=>this.props.handleConfirm(this.state.selectedPowers),color:"primary",children:"Save"}),Object(c.jsx)(o.a,{onClick:()=>this.props.handleClose(),color:"primary",children:"Cancel"})]})]})})]})}purchasePower(e,t,s){this.state.selectedPowers[e]=t,this.setState({remainingCP:this.state.remainingCP-s})}}var g=s(127),m=s(121);class f extends r.a.Component{constructor(e){super(e),this.state={selectedArch:this.props.selectedArch?this.props.selectedArch:"Standard",level:this.props.level?this.props.level:1},this.handleArchChange=this.handleArchChange.bind(this),this.handleLevelChange=this.handleLevelChange.bind(this)}componentDidMount(){}handleArchChange(e){this.setState({selectedArch:e.target.value})}handleLevelChange(e){this.setState({level:Number(e.target.value)})}render(){var e=this.state.level,t=this.state.selectedArch;return Object(c.jsxs)(l.a,{"aria-describedby":"Manage Archetype","aria-labelledby":"Manage Archetype",className:"manage-arch-dialog",fullWidth:!0,onClose:this.props.handleClose,open:!0,children:[Object(c.jsx)(d.a,{children:"Manage Archetype"}),Object(c.jsxs)(p.a,{children:[Object(c.jsxs)(u.a,{required:!0,variant:"outlined",children:[Object(c.jsx)("select",{value:this.state.selectedArch,onChange:this.handleArchChange,children:this.buildArchOptions()}),Object(c.jsx)(g.a,{id:"level-input",label:"Level",type:"number",value:this.state.level?this.state.level:1,inputProps:{min:"1",max:"10",step:"1"},onChange:this.handleLevelChange,className:"level-control"}),Object(c.jsx)(m.a,{children:Object(c.jsx)("table",{children:Object(c.jsx)("tbody",{children:this.props.archData.map(((s,a)=>{if(s.Arch===t)return Object(c.jsxs)("tr",{children:[Object(c.jsxs)("td",{children:[s.Row,":"]}),Object(c.jsx)("td",{children:s["Level "+e]})]})}))})})})]}),Object(c.jsxs)("div",{className:"actionButtons",children:[Object(c.jsx)(o.a,{onClick:()=>this.props.handleConfirm(this.state.selectedArch,this.state.level),color:"primary",children:"Save"}),Object(c.jsx)(o.a,{onClick:()=>this.props.handleClose(),color:"primary",children:"Cancel"})]})]})]})}buildArchOptions(){var e=[],t="";return this.props.archData.forEach((s=>{s.Arch&&s.Arch!==t&&(t=s.Arch,e.push(Object(c.jsx)("option",{value:t,children:t})))})),e}}class x extends r.a.Component{constructor(e){if(super(e),0===Object.keys(this.props.selectedStats).length){var t={};this.props.statData.forEach((e=>{var s=e.Stat;t[s]||(t[s]="H")})),this.state={selectedStats:t}}else this.state={selectedStats:this.props.selectedStats};this.handleStatChange=this.handleStatChange.bind(this)}componentDidMount(){}handleStatChange(e,t){var s=JSON.parse(JSON.stringify(this.state.selectedStats));s[e]=t,this.setState({selectedStats:s})}render(){return Object(c.jsxs)(l.a,{"aria-describedby":"Manage Archetype","aria-labelledby":"Manage Archetype",className:"manage-arch-dialog",fullWidth:!0,onClose:this.props.handleClose,open:!0,children:[Object(c.jsx)(d.a,{children:"Manage Stats"}),Object(c.jsxs)(p.a,{children:[Object(c.jsx)(u.a,{required:!0,variant:"outlined",children:Object.keys(this.state.selectedStats).map(((e,t)=>{var s=this.state.selectedStats[e];return Object(c.jsxs)(r.a.Fragment,{children:[e,Object(c.jsx)("select",{value:s,onChange:t=>this.handleStatChange(e,t.target.value),children:Object.keys(this.props.statData[0]).map(((e,t)=>e.startsWith("H")?Object(c.jsx)("option",{value:e,children:e}):void 0))})]})}))}),Object(c.jsxs)("div",{className:"actionButtons",children:[Object(c.jsx)(o.a,{onClick:()=>this.props.handleConfirm(this.state.selectedStats),color:"primary",children:"Save"}),Object(c.jsx)(o.a,{onClick:()=>this.props.handleClose(),color:"primary",children:"Cancel"})]})]})]})}}var w=s(129),O=s(123),v=s(122);class C extends r.a.Component{constructor(e){super(e)}render(){return Object(c.jsxs)(w.a,{display:"flex",children:[Object(c.jsx)(w.a,{minHeight:"25%",width:"30%",position:"Left",display:"flex",children:Object(c.jsxs)("div",{style:{width:"500px"},children:[Object(c.jsx)("h3",{children:"Attributes"}),0===this.props.naturals.length&&Object(c.jsx)("div",{children:"Select your Stats"}),this.props.naturals.map(((e,t)=>e.render())),Object(c.jsx)("h3",{children:"Active Buffs"}),this.props.buffs.map(((e,t)=>e.render()))]})}),Object(c.jsx)(w.a,{minHeight:"25%",width:"65%",position:"right",display:"flex",children:Object(c.jsxs)("div",{style:{width:"800px"},children:[Object(c.jsx)("h3",{children:" Abilities"}),Object(c.jsx)(v.a,{children:Object(c.jsx)(O.a,{"aria-label":"simple table",children:this.props.abilities.map(((e,t)=>e.render()))})})]})})]})}}var P=s(125),S=s(124);class A extends r.a.Component{constructor(e){super(e)}render(){if(this.props.tags.includes("passive")){var e=this.props.value+" "+this.props.effect,t=this.props.condition.length>0?" when "+this.props.condition:"",s="From "+this.props.source;return Object(c.jsxs)("div",{style:{backgroundColor:this.props.color},children:[e,t,Object(c.jsx)("br",{}),Object(c.jsx)("small",{children:s})]})}}renderAsBuffline(e){return Object(c.jsx)(S.a,{children:Object(c.jsx)(P.a,{padding:"none",children:this.props.value+" "+this.props.effect+(this.props.condition.length>0?" when "+this.props.condition:"")+(this.props.source===e?"":" from "+this.props.source)})})}appliesTo(e){var t=e.getName(),s=e.getTags();if(this.props.source===t)return!0;var a=!1;return this.props.tags.forEach((e=>{s.forEach((s=>{e!==s&&e!==t||(a=!0)}))})),a}getValue(){return this.props.value}getEffect(){return this.props.effect}getTags(){return this.props.tags}getName(){return this.props.source}}var y=s(132),M=s(126);class D extends r.a.Component{constructor(e){super(e)}render(){return Object(c.jsxs)(M.a,{style:{backgroundColor:this.props.color},children:[Object(c.jsx)(S.a,{children:Object(c.jsx)(P.a,{children:Object(c.jsx)("h5",{children:this.props.name})})}),Object(c.jsxs)(S.a,{children:[Object(c.jsx)(P.a,{padding:"none",children:this.props.action}),Object(c.jsx)(P.a,{padding:"none",children:this.getPriority()}),Object(c.jsxs)(P.a,{padding:"none",children:[this.getValue()+" "+this.props.effect,this.props.detail&&this.props.detail.length>0&&Object(c.jsx)(y.a,{title:this.props.detail.replaceAll('"',""),arrow:!0,interactive:!0,children:Object(c.jsx)(o.a,{children:"(?)"})})]})]}),this.props.buffs.map(((e,t)=>e.renderAsBuffline(this.props.name)))]})}getName(){return this.props.name}getTags(){return this.props.tags}getPriority(){var e=0;return this.props.tags.includes("atk")?(this.props.buffs.forEach((t=>{(t.getTags().includes("atk")||t.getTags().includes("priority"))&&(/^\d$/.test(t.getValue())?e+=Number(t.getValue()):console.log("strange interaction between "+this.props.name+" and buff "+t.getName()))})),"1d20"+(e>0?" + "+e:"")):""}getValue(){var e=0;return this.props.buffs.forEach((t=>{t.getEffect()===this.props.effect&&(/^\d$/.test(t.getValue())?e+=Number(t.getValue()):console.log("strange modifier in "+this.props.name))})),this.returnModifiedValue(this.props.value,e)}returnModifiedValue(e,t){return t>0?/^[\d]+$/.test(e)?Number(e)+Number(t)+" ("+e+" + "+t+")":e+" + "+t:e}addBuff(e){this.props.buffs.push(e)}}class k extends r.a.Component{constructor(e){super(e)}render(){return Object(c.jsx)("li",{children:Object(c.jsxs)("strong",{children:[this.props.name,": ",this.props.value]})})}getName(){return this.props.name}getTags(){return[]}addBuff(e){this.props.buffs.push(e)}}class N extends r.a.Component{constructor(e){super(e),this.closePanels=()=>{this.setState({showManagePowersPanel:!1,showManageArchPanel:!1,showManageStatsPanel:!1})},this.showManagePowersPanel=()=>{this.setState({showManagePowersPanel:!0})},this.showManageArchPanel=()=>{this.setState({showManageArchPanel:!0})},this.showManageStatsPanel=()=>{this.setState({showManageStatsPanel:!0})},this.getRank=(e,t)=>{switch(t){case 1:return e.lesserRank;case 2:return e.minorRank;case 3:return e.majorRank;default:return 0}},this.state={showManagePowersPanel:!1,showManageArchPanel:!1,showManageStatsPanel:!1,selectedPowers:{},selectedArch:"",selectedStats:{},level:1,powerData:[],archData:[],statData:[],abilities:[],buffs:[],naturals:[],arch:null}}componentDidMount(){let e=window.localStorage.getItem("selectedArch"),t=window.localStorage.getItem("level"),s=window.localStorage.getItem("selectedPowers"),a=window.localStorage.getItem("selectedStats");e&&this.setState({selectedArch:e}),t&&this.setState({level:JSON.parse(t)}),s&&this.setState({selectedPowers:JSON.parse(s)}),a&&this.setState({selectedStats:JSON.parse(a)}),fetch("https://raw.githubusercontent.com/aburnettt/adxsheets/master/src/data/powers.csv").then((e=>e.text())).then((e=>{this.setState({powerData:this.csvToJson(e)}),this.parseData()})),fetch("https://raw.githubusercontent.com/aburnettt/adxsheets/master/src/data/stats.csv").then((e=>e.text())).then((e=>{this.setState({statData:this.csvToJson(e)}),this.parseData()})),fetch("https://raw.githubusercontent.com/aburnettt/adxsheets/master/src/data/arch.csv").then((e=>e.text())).then((e=>{this.setState({archData:this.csvToJson(e)}),this.parseData()}))}render(){return Object(c.jsxs)("div",{children:[this.state.archData!==[]&&this.state.powerData!==[]&&Object(c.jsx)(h,{toggleManagePowers:this.showManagePowersPanel,toggleManageArch:this.showManageArchPanel,toggleManageStats:this.showManageStatsPanel}),Object(c.jsx)("main",{className:"container",children:""==this.state.selectedArch?Object(c.jsx)("strong",{children:"Select an Archetype"}):Object(c.jsx)(C,{abilities:this.state.abilities,buffs:this.state.buffs,naturals:this.state.naturals})}),this.state.showManagePowersPanel&&this.state.arch&&Object(c.jsx)(b,{powerData:this.state.powerData,selectedPowers:this.state.selectedPowers,totalCP:this.state.arch.characterPoints,handleConfirm:e=>this.updateSelectedPowers(e),handleClose:()=>this.closePanels()}),this.state.showManageArchPanel&&Object(c.jsx)(f,{archData:this.state.archData,selectedArch:this.state.selectedArch,level:this.state.arch?this.state.arch.level:1,handleConfirm:(e,t)=>this.updateSelectedArch(e,t),handleClose:()=>this.closePanels()}),this.state.showManageStatsPanel&&Object(c.jsx)(x,{statData:this.state.statData,selectedStats:this.state.selectedStats,handleConfirm:e=>this.updateSelectedStats(e),handleClose:()=>this.closePanels()})]})}updateSelectedArch(e,t){this.setState({selectedArch:e,level:t}),window.localStorage.setItem("selectedArch",e),window.localStorage.setItem("level",JSON.stringify(t)),this.parseData(this.state.selectedPowers,e,t),this.closePanels()}updateSelectedPowers(e){this.setState({selectedPowers:e}),window.localStorage.setItem("selectedPowers",JSON.stringify(e)),this.parseData(e),this.closePanels()}updateSelectedStats(e){alert("Updating "+JSON.stringify(e)),this.setState({selectedStats:e}),window.localStorage.setItem("selectedStats",JSON.stringify(e)),this.parseData(this.state.selectedPowers,this.state.selectedArch,this.state.level,e),this.closePanels()}csvToJson(e){for(var t=e.split("\r\n"),s=[],a=t[0].split(","),r=1;r<t.length;r++){for(var i={},n=t[r].split(","),o=0;o<a.length;o++)i[a[o]]=n[o];s.push(i)}return s}parseData(e=this.state.selectedPowers,t=this.state.selectedArch,s=this.state.level,a=this.state.selectedStats){if(""!==t&&0!==s&&this.state.archData!==[]&&this.state.powerData!==[]&&this.state.statData!==[]){var r={characterPoints:0,lesserRank:0,level:s,majorRank:0,minorRank:0,name:t,trainingPoints:0,willDice:0},i=[],n=[],o=[];this.state.archData.forEach((function(e){if(e.Arch===t){var a=e["Level "+s];e.Detail;switch(e.Row){case"CP":r.characterPoints=a;break;case"TP":r.trainingPoints=a;break;case"Major":r.majorRank=a;break;case"Minor":r.minorRank=a;break;case"Lesser":r.lesserRank=a;break;case"Will Dice":r.willDice=a}}})),this.state.statData.forEach((e=>{var t=e.Stat,s=a[t];if("X"!=e[s])switch(e.Row){case"Ability":i.push(new D({action:e.Action,name:e.Attribute,value:e[s],effect:e.Effect,detail:e.Detail,tags:e.Tags.length>0?e.Tags.split(" "):[],condition:e.Condition,buffs:[],color:this.nameToColor(t)}));break;case"Natural":o.push(new k({name:e.Attribute,value:e[s],buffs:[]}));break;case"Buff":n.push(new A({source:e,effect:e.Effect,value:e[s],condition:e.Condition,detail:e.Detail,tags:e.Tags.length>0?e.Tags.split(" "):[],color:this.nameToColor(t)}))}})),this.state.powerData.forEach((t=>{if(e[t.Power]&&e[t.Power]>0&&r){var s=this.getRank(r,e[t.Power]);"Ability"===t.Row?i.push(new D({action:t.Action,name:t.Power,value:t["r"+s],effect:t.Effect,detail:t.Detail,tags:t.Tags.length>0?t.Tags.split(" "):[],condition:t.Condition,buffs:[],color:this.nameToColor(t.Power)})):"Buff"===t.Row&&n.push(new A({source:t.Power,effect:t.Effect,value:t["r"+s],condition:t.Condition,detail:t.Detail,tags:t.Tags.length>0?t.Tags.split(" "):[],color:this.nameToColor(t.Power)}))}})),n.map(((e,t)=>{i.map(((t,s)=>{this.tryOnBuff(t,e)})),o.map(((t,s)=>{this.tryOnBuff(t,e)}))})),this.setState({abilities:i,buffs:n,naturals:o,arch:r})}}tryOnBuff(e,t){if(e.getName()===t.getName())return e.addBuff(t),!0;e.getTags().forEach((s=>{if(t.getTags().includes(s))return e.addBuff(t),!0}))}nameToColor(e){var t=0,s=e.length,a=0;if(s>0)for(;a<s;)t=(t<<5)-t+e.charCodeAt(a++)|0;var r=Math.abs(t).toString(16);return"#"+(255-Math.round(parseInt(r.substr(0,2),16)/2)).toString(16)+(255-Math.round(parseInt(r.substr(2,2),16)/2)).toString(16)+(255-Math.round(parseInt(r.substr(4,2),16)/2)).toString(16)}}s(84),s(85);n.a.render(Object(c.jsx)(N,{}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.910b3a5e.chunk.js.map